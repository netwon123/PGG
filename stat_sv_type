import argparse
import vcf

# 定义命令行参数
parser = argparse.ArgumentParser(description='统计VCF文件中各种类型结构变异的数量')
parser.add_argument('vcf_file', help='输入的VCF文件')
args = parser.parse_args()

# 定义结构变异类型
svtypes = set(['DEL', 'DUP', 'INV', 'INS', 'BND'])

# 定义变异计数器
svcounts = { svtype: 0 for svtype in svtypes }

# 打开VCF文件
vcf_reader = vcf.Reader(open(args.vcf_file, 'r'))

# 遍历每个变异
for record in vcf_reader:
    # 检查是否为结构变异类型
    if record.var_subtype in svtypes:
        # 记录结构变异类型数量
        svcounts[record.var_subtype] += 1

# 输出结果
for svtype in svtypes:
    print('{0}: {1}'.format(svtype, svcounts[svtype]))

#python stat_sv_type.py x.vcf
